<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <head>
        <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Notifications</title>
        <th:block th:insert="~{partials/styles :: styles}"></th:block>
        <link rel="stylesheet" href="/styles/notifications.css"/>
    </head>
<body>
<th:block th:insert="~{partials/navbar :: navbar}"></th:block>

<!--page content-->
<div id="page-content-with-footer">
    <div id="page-content-without-footer" class="page-content-notifications" sec:authorize="isAuthenticated()">

        <div class="general-notification-info">
            <div><span th:text="${loggedInUser.username}"></span>, you have <span th:text="${requestCount}"></span>
                notifications
            </div>
        </div>

        <div class="all-request-container">

            <!--group requests-->
            <div class="group-request-container">
                <h3 class="content-header-notifications">Group Requests</h3>
                <div th:each="membership : ${membershipRequests}">
                    <div class="request-div">
                        <a class="notifications-image-a"
                           th:href="@{/profile/{username}(username=${membership.user.username})}">
                            <img class="notification-user-photo" th:src="${membership.user.profilePhotoUrl}"
                                 alt="friend photo">
                        </a>
                        <a th:href="@{/profile/{username}(username=${membership.user.username})}">
                            <span th:text="${membership.user.firstName}"></span> <span
                                th:text="${membership.user.lastName}"></span>
                        </a>
                        <p>sent you a group request for <span class="group-font-notifications"
                                                              th:text="${membership.group}"></span></p>
                    </div>

                    <div class="notification-button-div">
                        <form th:action="@{/notifications/accept/{id}(id=${membership.id})}" th:method="POST">
                            <button class="btn btn-outline-success">Confirm</button>
                        </form>
                        <form th:action="@{/notifications/deny/{id}(id=${membership.id})}" th:method="POST">
                            <button class="btn btn-outline-danger">Delete</button>
                        </form>
                    </div>
                </div>
            </div>

            <!--friend requests-->
            <div class="friend-request-container">
                <h3 class="content-header-notifications">Friend Requests</h3>
                <div th:each="friendship : ${friendshipRequests}">
                    <div>
                        <div></div>
                        <p><a th:text="${friendship.requester.username}"
                              th:href="@{/profile/{username}(username=${friendship.requester.username})}"></a> sent you
                            a friend request</p>
                        <form th:action="@{/profile/{userId}/accept(userId=${friendship.requester.id})}"
                              th:method="POST">
                            <input th:name="currentPage" th:value="notifications-page" hidden>
                            <button id="accept-friend-request-btn" type="submit" class="btn btn-primary">
                                Confirm
                            </button>
                        </form>
                        <form th:action="@{/profile/{userId}/decline(userId=${friendship.requester.id})}"
                              th:method="GET">
                            <input th:name="currentPage" th:value="notifications-page" hidden>
                            <button id="remove-friend-btn" type="submit" class="btn btn-danger">
                                Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <div class="footer-stationary">
        <th:block th:insert="~{partials/footer :: footer}"></th:block>
    </div>
</div>
</body>
</html>