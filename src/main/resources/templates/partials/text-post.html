<th:block th:fragment="text-post">

	<div class="post-card list-group-item list-group-item-action my-2">
		<div th:id="'post-content'+${post.id}">
			<div class="d-flex w-100 justify-content-between post-item">
				<div class="posted-by-info">
					<div class="group-photo"></div>
					<div class="user-photo">
					</div>
					<a th:href="@{'/profile/' + ${post.user.username}}"><small><span
							th:text="${post.user}"></span></small></a>
					<small>posted in </small>
					<a th:href="@{'/group/' + ${post.group.id}}"><small><span
							th:text="${post.group}"></span></small></a>
				</div>
				<div>
					<small th:text="${post.postDateToString()}"></small>
				</div>
			</div>
			<h5 class="mb-1"><span th:text="${post.header}"></span></h5>
			<p class="mb-1"><span th:text="${post.body}"></span></p>
		</div>

		<div sec:authorize="isAuthenticated()">

			<form method="post" th:id="'hidden-form'+${post.id}" th:action="@{/post/text/edit}" hidden>
				<div class="d-flex w-100 justify-content-between post-item">
					<input th:name="header" class="mb-1" th:value="${post.header}">
					<small th:text="${post.postDateToString()}"></small>
				</div>
				<input th:name="body" class="mb-1" th:value="${post.body}">
				<br>
				<small><span th:text="${post.user}"></span></small>

				<input th:name="id" class="mb-1" th:value="${post.id}" hidden>


				<div th:if="${loggedInUser.id == post.user.id}">
					<button type="button" onclick="cancelEditingPost(event)" th:id="'cancel-button'+${post.id}"
							class="btn btn-secondary">Cancel
					</button>

					<button type="submit" th:id="'save-button'+${post.id}"
							class="btn btn-success">Save
					</button>
				</div>
			</form>

			<div th:if="${loggedInUser.id == post.user.id}">
				<button type="button" onclick="editPost(event)" th:id="'edit-button'+${post.id}"
						class="btn btn-warning">
					Edit
				</button>

				<form th:method="post" th:action="@{/post/delete}">
					<input th:name="id" class="mb-1" th:value="${post.id}" hidden>
					<input th:name="groupId" class="mb-1" th:value="${post.group.id}" hidden>
					<button type="submit" th:id="'delete-button'+${post.id}"
							class="btn btn-danger">
						Delete
					</button>
				</form>
			</div>
		</div>

		<div>
			<h6>Comments</h6>

			<ul class="list-group" th:each="comment : ${comments}" th:if="${!comments.isEmpty()}">
				<li th:if="${comment.post.id == post.id}" class="list-group-item">
					<a th:href="@{/profile/{username}(username=${comment.commenter.username})}"><strong><span th:text="${comment.commenter}"></span></strong></a> <span th:text="${comment.content}"></span>
					<div sec:authorize="isAuthenticated()" th:if="${comment.commenter.id == loggedInUser.id}">
						<button th:id="'edit-comment-button'+${comment.id}" onclick="showEditCommentForm(event)" class="btn btn-warning">Edit</button>
						<form hidden th:id="'edit-comment-form'+${comment.id}" th:action="@{/comment/edit}" th:method="post">
							<input th:name="commentId" th:value="${comment.id}" hidden>
							<input th:name="commentContent" type="text">
							<button type="button" th:id="'cancel-edit-comment-button'+${comment.id}" onclick="hideEditCommentForm(event)" class="btn btn-warning">Cancel</button>
							<button type="submit" class="btn btn-primary">Save</button>
						</form>
						<form th:action="@{/comment/delete}" th:method="post">
							<input th:name="commentId" th:value="${comment.id}" hidden>
							<button type="submit" class="btn btn-danger">Delete</button>
						</form>
					</div>
				</li>
			</ul>

			<br>

			<div sec:authorize="isAuthenticated()">
				<form th:method="post" th:action="@{/{postId}/comment/add(postId=${post.id})}">
					<div class="input-group mb-3">
						<input th:name="commentContent" type="text" class="form-control"
							   placeholder="Type in a comment...">
						<input th:name="groupId" th:value="${post.group.id}" hidden>
						<div class="input-group-append">
							<button class="btn btn-outline-secondary" type="submit">Add Comment</button>
						</div>
					</div>
				</form>
			</div>
		</div>

	</div>

</th:block>

