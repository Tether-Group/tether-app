<!DOCTYPE html>
<html lang="en"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<head>
		<meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Create group</title>
		<th:block th:insert="~{partials/styles :: styles}"></th:block>
		<link rel="stylesheet" href="/styles/create-group.css"/>
	</head>
<body>
<th:block th:insert="~{partials/navbar :: navbar}"></th:block>

<div class="form-container">
	<h1>Create A New Group</h1>
<form th:method="post" th:action="@{/group/create}" th:object="${group}">
	<div class="mx-auto">

		<div class="photo-container">
			<button type="button" class="photo-btn btn btn-secondary" onclick="openFileStackModal()">Add cover photo</button>
			<input hidden id="photo-url" th:name="photo-url">
			<div id="preview"><p class="no-photo-selected" id="no-photo-selected">No photo selected</p></div>
		</div>

		<div class="group-name-div form-floating mb-3">
			<input type="text" class="form-control" id="group-name" placeholder="Example Group Name" th:field="*{name}" required>
			<label for="group-name">Group Name</label>
		</div>
		<br>
		<div class="form-floating group-description-text-area">
			<textarea class="form-control" placeholder="Group Description Here" id="description" th:field="*{description}" style="height: 150px"></textarea>
			<label for="description">Group Description</label>
		</div>
		<br>
		<label for="visibility">Visibility:</label>
		<input type="checkbox" name="private" th:field="*{private}" id="visibility">
		<span>Private</span>
		<br>
		<label for="post-types">Post Types:</label>
		<select name="postTypes" id="post-types" th:field="*{postTypes}" multiple>
			<option value="2">Event</option>
			<option value="3">For Sale</option>
			<option value="4">Q&A</option>
		</select>
		<br>
		<input type="hidden" th:field="*{id}">
	</div>
	<div class="mx-auto">
		<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
		<button type="submit" class="btn btn-primary">Create Group</button>
	</div>
</form>
</div>

<th:block th:insert="~{partials/footer :: footer}"></th:block>
<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<script>
	const preview = document.getElementById("preview");
	const photoText = document.getElementById("no-photo-selected")
    const inputForPhotoURL = document.getElementById("photo-url");

    const client = filestack.init(FILESTACK_API_KEY);
	const options = {
        onFileUploadFinished(file) {
            inputForPhotoURL.value = file.url;
			photoText.style.display = "none"
			preview.innerHTML = `<img src="${file.url}" alt="preview">`
		}
	}
    const openFileStackModal = () => {
        client.picker(options).open();
    };

</script>
</body>
</html>